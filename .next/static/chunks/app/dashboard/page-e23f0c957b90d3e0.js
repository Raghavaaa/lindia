(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{6245:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m});var i=r(5155),s=r(2115),l=r(2619),d=r.n(l),a=r(9466);function c(){let{clients:e,active:t,setActive:r}=(0,a.C)();return(0,i.jsx)("aside",{className:"w-64 shrink-0",children:(0,i.jsxs)("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white dark:bg-zinc-900 p-4 space-y-2",children:[(0,i.jsx)("h2",{className:"text-xs uppercase tracking-wider text-zinc-500 dark:text-zinc-400 px-2",children:"Clients"}),(0,i.jsx)("div",{className:"mt-1 flex flex-col",children:0===e.length?(0,i.jsx)("div",{className:"px-3 py-2 text-sm text-zinc-500",children:"No clients yet. Add above."}):e.map(e=>{let s=t.clientId===e.id;return(0,i.jsx)("button",{onClick:()=>r({clientId:e.id}),className:"text-left px-3 py-2 rounded-xl text-sm hover:bg-zinc-100 dark:hover:bg-zinc-800 ".concat(s?"bg-zinc-100 dark:bg-zinc-800":""),children:e.name},e.id)})}),(0,i.jsx)("div",{className:"pt-2 border-t border-black/5 dark:border-white/10",children:(0,i.jsx)(d(),{href:"/settings",className:"block px-3 py-2 rounded-xl text-sm hover:bg-zinc-100 dark:hover:bg-zinc-800",children:"Settings"})})]})})}let n=[{key:"property",label:"Property Opinions"},{key:"research",label:"Research"},{key:"case",label:"Case"},{key:"junior",label:"Junior"}];function o(e){let{active:t="property",onChange:r}=e;return(0,i.jsx)("div",{className:"w-full flex justify-end",children:(0,i.jsx)("div",{className:"flex items-center gap-2 p-2 rounded-2xl bg-zinc-50 dark:bg-zinc-900/50 border border-black/5 dark:border-white/10",children:n.map(e=>{let{key:s,label:l}=e,d=s===t;return(0,i.jsx)("button",{type:"button",onClick:()=>null==r?void 0:r(s),className:"px-4 py-2 rounded-full text-sm font-medium transition-colors "+(d?"bg-black text-white dark:bg-white dark:text-black":"bg-white dark:bg-zinc-800 text-zinc-700 dark:text-zinc-300 hover:bg-zinc-100 dark:hover:bg-zinc-700"),children:l},s)})})})}function x(){let e=(0,s.useId)(),[t,r]=(0,s.useState)(!1),[l,d]=(0,s.useState)(null),a="http://localhost:4000";async function c(e){if(e.preventDefault(),d(null),!a)return void d("Missing NEXT_PUBLIC_API_URL");let t=e.currentTarget,i=new FormData(t),s=i.get("file");if(!(s instanceof File)||0===s.size)return void d("Please choose a file to upload.");r(!0);try{let e=await fetch("".concat(a,"/upload"),{method:"POST",body:i});if(!e.ok){let t=await e.text();throw Error(t||"Upload failed with status ".concat(e.status))}d("Upload successful."),t.reset()}catch(e){d(e.message)}finally{r(!1)}}return(0,i.jsxs)("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white dark:bg-zinc-900 p-6",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Upload"}),(0,i.jsx)("p",{className:"text-sm text-zinc-600 dark:text-zinc-400 mb-4",children:"Upload documents to process within Directories."}),(0,i.jsxs)("form",{onSubmit:c,className:"space-y-4",children:[(0,i.jsxs)("div",{className:"flex items-center gap-3",children:[(0,i.jsx)("label",{htmlFor:e,className:"text-sm w-24",children:"File"}),(0,i.jsx)("input",{id:e,name:"file",type:"file",className:"block w-full text-sm"})]}),(0,i.jsx)("div",{className:"flex items-center gap-3",children:(0,i.jsx)("button",{type:"submit",disabled:t||!a,className:"inline-flex items-center justify-center rounded-xl px-4 py-2 text-sm font-medium text-white bg-black hover:bg-zinc-800 disabled:opacity-60",children:t?"Uploading...":a?"Upload":"Upload (API URL missing)"})}),l&&(0,i.jsx)("div",{className:"text-sm text-zinc-700 dark:text-zinc-300",children:l})]})]})}function u(e){let{onClose:t}=e,{clients:r,addClient:l,setActive:d}=(0,a.C)(),[c,n]=(0,s.useState)(""),[o,x]=(0,s.useState)(!1),[u,b]=(0,s.useState)(""),[m,h]=(0,s.useState)(""),p=(0,s.useMemo)(()=>{let e=c.trim().toLowerCase();return e?r.filter(t=>t.name.toLowerCase().includes(e)):r},[r,c]);return(0,s.useEffect)(()=>{function e(e){"Escape"===e.key&&(null==t||t())}return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[t]),(0,i.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,i.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:t}),(0,i.jsxs)("div",{className:"relative z-10 w-full max-w-md rounded-2xl border border-black/5 dark:border-white/10 bg-white dark:bg-zinc-900 p-6",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Select client or add new"}),(0,i.jsx)("input",{value:c,onChange:e=>n(e.target.value),placeholder:"Search clients...",className:"w-full rounded-xl border border-black/10 dark:border-white/10 bg-white dark:bg-zinc-800 px-3 py-2 text-sm"}),(0,i.jsxs)("div",{className:"mt-3 max-h-48 overflow-auto space-y-1",children:[p.map(e=>(0,i.jsx)("button",{onClick:()=>{d({clientId:e.id}),null==t||t()},className:"w-full text-left px-3 py-2 rounded-xl text-sm hover:bg-zinc-100 dark:hover:bg-zinc-800",children:e.name},e.id)),0===p.length&&(0,i.jsx)("div",{className:"text-sm text-zinc-500 px-3 py-2",children:"No matches"})]}),o?(0,i.jsxs)("div",{className:"mt-4 space-y-3",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm mb-1",children:"Client name"}),(0,i.jsx)("input",{value:u,onChange:e=>b(e.target.value),className:"w-full rounded-xl border border-black/10 dark:border-white/10 bg-white dark:bg-zinc-800 px-3 py-2 text-sm"})]}),(0,i.jsxs)("div",{children:[(0,i.jsx)("label",{className:"block text-sm mb-1",children:"Reference ID (optional)"}),(0,i.jsx)("input",{value:m,onChange:e=>h(e.target.value),className:"w-full rounded-xl border border-black/10 dark:border-white/10 bg-white dark:bg-zinc-800 px-3 py-2 text-sm"})]}),(0,i.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,i.jsx)("button",{onClick:t,className:"px-3 py-2 rounded-xl text-sm font-medium bg-white dark:bg-zinc-800 border border-black/10 dark:border-white/10",children:"Cancel"}),(0,i.jsx)("button",{onClick:function(){let e=u.trim();e&&(d({clientId:l(e,m.trim()||void 0).id}),null==t||t())},className:"px-3 py-2 rounded-xl text-sm font-medium bg-black text-white",children:"Create"})]})]}):(0,i.jsx)("div",{className:"mt-4 flex justify-end",children:(0,i.jsx)("button",{onClick:()=>x(!0),className:"px-3 py-2 rounded-xl text-sm font-medium bg-black text-white",children:"Add New Client"})})]})]})}function b(e){let{userId:t,onClose:r}=e,[l,d]=(0,s.useState)(""),[a,c]=(0,s.useState)(!1),[n,o]=(0,s.useState)(null),[x,u]=(0,s.useState)(null);async function b(e){e.preventDefault(),c(!0),u(null),o(null);try{var r;let e=await fetch("/api/research",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:l,userId:t})}),i=await e.json();if(!e.ok)throw Error((null==i?void 0:i.error)||"Request failed");o(String(null!=(r=i.result)?r:""))}catch(e){u(e.message)}finally{c(!1)}}return(0,i.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,i.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:r}),(0,i.jsxs)("div",{className:"relative z-10 w-full max-w-2xl rounded-2xl border border-black/5 dark:border-white/10 bg-white dark:bg-zinc-900 p-6",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Research"}),(0,i.jsxs)("form",{onSubmit:b,className:"space-y-3",children:[(0,i.jsx)("textarea",{value:l,onChange:e=>d(e.target.value),placeholder:"Describe your research question...",className:"w-full min-h-28 rounded-xl border border-black/10 dark:border-white/10 bg-white dark:bg-zinc-800 px-3 py-2 text-sm"}),(0,i.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,i.jsx)("button",{type:"button",onClick:r,className:"px-3 py-2 rounded-xl text-sm bg-white dark:bg-zinc-800 border border-black/10 dark:border-white/10",children:"Close"}),(0,i.jsx)("button",{disabled:a||!l.trim(),className:"px-4 py-2 rounded-xl text-sm font-medium bg-black text-white disabled:opacity-60",children:a?"Running...":"Run Research"})]})]}),x&&(0,i.jsx)("div",{className:"mt-3 text-sm text-red-600",children:x}),n&&(0,i.jsx)("div",{className:"mt-4 rounded-xl border border-black/5 dark:border-white/10 bg-white dark:bg-zinc-800 p-4 whitespace-pre-wrap text-sm",children:n})]})]})}function m(){var e;let{active:t,setActive:r,directories:l,subdirectories:d,addDirectory:n,addSubdirectory:m,getClientName:h}=(0,a.C)(),[p,k]=(0,s.useState)(void 0),[f,g]=(0,s.useState)(!1),[v,w]=(0,s.useState)(!1),j=!!t.clientId,y=j&&!!p,N=l.find(e=>e.id===t.directoryId),z=d.find(e=>e.id===t.subdirectoryId);return(0,i.jsxs)("div",{className:"mx-auto max-w-7xl px-6 py-6 space-y-6",children:[(0,i.jsx)(o,{active:p,onChange:function(e){if(!j)return void g(!0);k(e),"research"===e&&w(!0)}}),(0,i.jsxs)("div",{className:"flex items-start gap-6",children:[(0,i.jsx)(c,{}),(0,i.jsx)("div",{className:"flex-1 space-y-6",children:y?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white dark:bg-zinc-900 p-6",children:(0,i.jsxs)("h3",{className:"text-sm uppercase tracking-wider text-zinc-500 dark:text-zinc-400 mb-1",children:["property"===p&&"Property Opinions","research"===p&&"Research","case"===p&&"Case","junior"===p&&"Junior",t.clientId?" â€¢ ".concat(null!=(e=h(t.clientId))?e:""):""]})}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,i.jsxs)("section",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white dark:bg-zinc-900 p-6",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("h4",{className:"text-xs uppercase tracking-wider text-zinc-500 dark:text-zinc-400",children:"Directories"}),(0,i.jsx)("button",{className:"px-3 py-1.5 rounded-xl text-sm font-medium bg-black text-white",onClick:()=>{if(!t.clientId)return;let e=window.prompt("New directory name?");e&&r({directoryId:n(t.clientId,e).id,subdirectoryId:void 0})},children:"New Directory"})]}),(0,i.jsx)("div",{className:"mt-3 space-y-2",children:l.filter(e=>e.clientId===t.clientId).map(e=>(0,i.jsx)("button",{onClick:()=>r({directoryId:e.id,subdirectoryId:void 0}),className:"w-full text-left px-3 py-2 rounded-xl text-sm hover:bg-zinc-100 dark:hover:bg-zinc-800 ".concat(t.directoryId===e.id?"bg-zinc-100 dark:bg-zinc-800":""),children:e.name},e.id))}),N&&!z&&(0,i.jsx)("div",{className:"mt-4",children:(0,i.jsx)(x,{})})]}),(0,i.jsxs)("section",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white dark:bg-zinc-900 p-6",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsx)("h4",{className:"text-xs uppercase tracking-wider text-zinc-500 dark:text-zinc-400",children:"Subdirectories"}),(0,i.jsx)("button",{className:"px-3 py-1.5 rounded-xl text-sm font-medium bg-black text-white",onClick:()=>{if(!t.directoryId)return;let e=window.prompt("New subdirectory name?");e&&r({subdirectoryId:m(t.directoryId,e).id})},children:"New Subdirectory"})]}),(0,i.jsx)("div",{className:"mt-3 space-y-2",children:d.filter(e=>e.directoryId===t.directoryId).map(e=>(0,i.jsx)("button",{onClick:()=>r({subdirectoryId:e.id}),className:"w-full text-left px-3 py-2 rounded-xl text-sm hover:bg-zinc-100 dark:hover:bg-zinc-800 ".concat(t.subdirectoryId===e.id?"bg-zinc-100 dark:bg-zinc-800":""),children:e.name},e.id))}),z&&(0,i.jsx)("div",{className:"mt-4",children:(0,i.jsx)(x,{})})]})]})]}):(0,i.jsx)("div",{className:"rounded-2xl border border-black/5 dark:border-white/10 bg-white dark:bg-zinc-900 p-10 text-center text-zinc-600 dark:text-zinc-400",children:"Choose an option at top-right to begin."})})]}),f&&(0,i.jsx)(u,{onClose:()=>g(!1)}),v&&(0,i.jsx)(b,{userId:t.clientId,onClose:()=>w(!1)})]})}},6358:(e,t,r)=>{Promise.resolve().then(r.bind(r,6245))},9466:(e,t,r)=>{"use strict";r.d(t,{AppStoreProvider:()=>c,C:()=>n});var i=r(5155),s=r(2115);let l=(0,s.createContext)(null),d="legalindia.store.v1";function a(e){return"".concat(e,"_").concat(Math.random().toString(36).slice(2,10))}function c(e){let{children:t}=e,[r,c]=(0,s.useState)(()=>{try{var e;let t=window.localStorage.getItem(d);if(!t)return{clients:[],directories:[],subdirectories:[],active:{}};let r=JSON.parse(t);return{...r,active:null!=(e=r.active)?e:{}}}catch(e){return{clients:[],directories:[],subdirectories:[],active:{}}}});(0,s.useEffect)(()=>{try{window.localStorage.setItem(d,JSON.stringify(r))}catch(e){}},[r]);let n=(0,s.useCallback)(e=>{c(t=>({...t,active:{...t.active,...e}}))},[]),o=(0,s.useCallback)((e,t)=>{let r={id:a("cli"),name:e,referenceId:t};return c(e=>({...e,clients:[...e.clients,r]})),r},[]),x=(0,s.useCallback)(e=>{c(t=>({...t,clients:t.clients.filter(t=>t.id!==e),directories:t.directories.filter(t=>t.clientId!==e),subdirectories:t.subdirectories.filter(r=>{var i;return(null==(i=t.directories.find(e=>e.id===r.directoryId))?void 0:i.clientId)!==e}),active:t.active.clientId===e?{}:t.active}))},[]),u=(0,s.useCallback)((e,t)=>{let r={id:a("dir"),name:t,clientId:e};return c(e=>({...e,directories:[...e.directories,r]})),r},[]),b=(0,s.useCallback)((e,t)=>{let r={id:a("sub"),name:t,directoryId:e};return c(e=>({...e,subdirectories:[...e.subdirectories,r]})),r},[]),m=(0,s.useCallback)(e=>{c(t=>({...t,logoDataUrl:e}))},[]),h=(0,s.useCallback)(e=>{var t;return null==(t=r.clients.find(t=>t.id===e))?void 0:t.name},[r.clients]),p=(0,s.useMemo)(()=>({...r,setActive:n,addClient:o,removeClient:x,addDirectory:u,addSubdirectory:b,setLogoDataUrl:m,getClientName:h}),[r,n,o,x,u,b,m,h]);return(0,i.jsx)(l.Provider,{value:p,children:t})}function n(){let e=(0,s.useContext)(l);if(!e)throw Error("useAppStore must be used within AppStoreProvider");return e}}},e=>{e.O(0,[619,441,255,358],()=>e(e.s=6358)),_N_E=e.O()}]);